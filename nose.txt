BEGIN;
ALTER TABLE "Administrativo_facultad" RENAME TO "Facultad";
ALTER TABLE "Administrativo_materia" RENAME TO "Materia";
ALTER TABLE "Administrativo_programa" RENAME TO "Programa";

COMMIT;
BEGIN;
CREATE TABLE "Administrativo_aula" ("id" integer NOT NULL PRIMARY KEY AUTOINCREMENT, "nombre" varchar(50) NOT NULL);
CREATE TABLE "Administrativo_bloque" ("nombre" varchar(2) NOT NULL PRIMARY KEY);
CREATE TABLE "Administrativo_ciudad" ("codigo" varchar(10) NOT NULL PRIMARY KEY, "nombre" varchar(50) NOT NULL);
CREATE TABLE "Administrativo_departamento" ("codigo" varchar(10) NOT NULL PRIMARY KEY, "nombre" varchar(50) NOT NULL);
CREATE TABLE "Administrativo_facultad" ("codigo" varchar(10) NOT NULL PRIMARY KEY, "nombre" varchar(50) NOT NULL);
CREATE TABLE "Administrativo_hora" ("codigo" varchar(10) NOT NULL PRIMARY KEY, "dia" varchar(20) NOT NULL, "horainicio" time NOT NULL, "horafinal" time NOT NULL);
CREATE TABLE "Administrativo_horarioaula" ("id" integer NOT NULL PRIMARY KEY AUTOINCREMENT, "aula_id" integer NOT NULL REFERENCES "Administrativo_aula" ("id"), "hora_id" varchar(10) NOT NULL REFERENCES "Administrativo_hora" ("codigo"));
CREATE TABLE "Administrativo_materia" ("codigo" varchar(10) NOT NULL PRIMARY KEY, "nombre" varchar(50) NOT NULL, "creditos" integer NOT NULL, "prerequisito_id" varchar(10) NULL REFERENCES "Administrativo_materia" ("codigo"));
CREATE TABLE "Administrativo_pensum" ("codigo" varchar(10) NOT NULL PRIMARY KEY, "nombre" varchar(50) NOT NULL, "creditos" integer NOT NULL);
CREATE TABLE "Administrativo_pensum_materias" ("id" integer NOT NULL PRIMARY KEY AUTOINCREMENT, "pensum_id" varchar(10) NOT NULL REFERENCES "Administrativo_pensum" ("codigo"), "materia_id" varchar(10) NOT NULL REFERENCES "Administrativo_materia" ("codigo"), UNIQUE ("pensum_id", "materia_id"));
CREATE TABLE "Administrativo_persona" ("tipo_documento" varchar(20) NOT NULL, "documento" integer NOT NULL PRIMARY KEY, "fecha_expedicion" date NOT NULL, "primer_nombre" varchar(30) NOT NULL, "segundo_nombre" varchar(30) NULL, "primer_apellido" varchar(30) NOT NULL, "segundo_apellido" varchar(30) NULL, "sexo" varchar(1) NOT NULL, "fecha_nacimiento" date NOT NULL, "direccion" varchar(100) NOT NULL, "telefono" integer NOT NULL, "correo" varchar(254) NULL UNIQUE);
CREATE TABLE "Administrativo_programa" ("codigo" varchar(10) NOT NULL PRIMARY KEY, "nombre" varchar(50) NOT NULL, "facultad_id" varchar(10) NOT NULL REFERENCES "Administrativo_facultad" ("codigo"));
CREATE TABLE "Administrativo_jefedepartamento" ("persona_ptr_id" integer NOT NULL PRIMARY KEY REFERENCES "Administrativo_persona" ("documento"), "programa_id" varchar(10) NOT NULL UNIQUE REFERENCES "Administrativo_programa" ("codigo"));
CREATE TABLE "Administrativo_persona__new" ("tipo_documento" varchar(20) NOT NULL, "documento" integer NOT NULL PRIMARY KEY, "fecha_expedicion" date NOT NULL, "primer_nombre" varchar(30) NOT NULL, "segundo_nombre" varchar(30) NULL, "primer_apellido" varchar(30) NOT NULL, "segundo_apellido" varchar(30) NULL, "sexo" varchar(1) NOT NULL, "fecha_nacimiento" date NOT NULL, "direccion" varchar(100) NOT NULL, "telefono" integer NOT NULL, "correo" varchar(254) NULL UNIQUE, "lugar_expedicion_id" varchar(10) NOT NULL REFERENCES "Administrativo_ciudad" ("codigo"));
INSERT INTO "Administrativo_persona__new" ("fecha_nacimiento", "lugar_expedicion_id", "fecha_expedicion", "sexo", "correo", "segundo_apellido", "direccion", "segundo_nombre", "primer_apellido", "primer_nombre", "tipo_documento", "telefono", "documento") SELECT "fecha_nacimiento", NULL, "fecha_expedicion", "sexo", "correo", "segundo_apellido", "direccion", "segundo_nombre", "primer_apellido", "primer_nombre", "tipo_documento", "telefono", "documento" FROM "Administrativo_persona";
DROP TABLE "Administrativo_persona";
ALTER TABLE "Administrativo_persona__new" RENAME TO "Administrativo_persona";
CREATE INDEX "Administrativo_horarioaula_d54dda25" ON "Administrativo_horarioaula" ("aula_id");
CREATE INDEX "Administrativo_horarioaula_1069c7b1" ON "Administrativo_horarioaula" ("hora_id");
CREATE INDEX "Administrativo_materia_e115cbe6" ON "Administrativo_materia" ("prerequisito_id");
CREATE INDEX "Administrativo_pensum_materias_28eee2e0" ON "Administrativo_pensum_materias" ("pensum_id");
CREATE INDEX "Administrativo_pensum_materias_d918f6e2" ON "Administrativo_pensum_materias" ("materia_id");
CREATE INDEX "Administrativo_programa_00e3be6f" ON "Administrativo_programa" ("facultad_id");
CREATE INDEX "Administrativo_persona_83d17944" ON "Administrativo_persona" ("lugar_expedicion_id");
CREATE TABLE "Administrativo_persona__new" ("tipo_documento" varchar(20) NOT NULL, "documento" integer NOT NULL PRIMARY KEY, "fecha_expedicion" date NOT NULL, "primer_nombre" varchar(30) NOT NULL, "segundo_nombre" varchar(30) NULL, "primer_apellido" varchar(30) NOT NULL, "segundo_apellido" varchar(30) NULL, "sexo" varchar(1) NOT NULL, "fecha_nacimiento" date NOT NULL, "direccion" varchar(100) NOT NULL, "telefono" integer NOT NULL, "correo" varchar(254) NULL UNIQUE, "lugar_expedicion_id" varchar(10) NOT NULL REFERENCES "Administrativo_ciudad" ("codigo"), "lugar_nacimiento_id" varchar(10) NOT NULL REFERENCES "Administrativo_ciudad" ("codigo"));
INSERT INTO "Administrativo_persona__new" ("fecha_nacimiento", "lugar_expedicion_id", "fecha_expedicion", "lugar_nacimiento_id", "sexo", "correo", "segundo_apellido", "direccion", "segundo_nombre", "primer_apellido", "primer_nombre", "tipo_documento", "telefono", "documento") SELECT "fecha_nacimiento", "lugar_expedicion_id", "fecha_expedicion", NULL, "sexo", "correo", "segundo_apellido", "direccion", "segundo_nombre", "primer_apellido", "primer_nombre", "tipo_documento", "telefono", "documento" FROM "Administrativo_persona";
DROP TABLE "Administrativo_persona";
ALTER TABLE "Administrativo_persona__new" RENAME TO "Administrativo_persona";
CREATE INDEX "Administrativo_persona_83d17944" ON "Administrativo_persona" ("lugar_expedicion_id");
CREATE INDEX "Administrativo_persona_da7c448b" ON "Administrativo_persona" ("lugar_nacimiento_id");
CREATE TABLE "Administrativo_persona__new" ("tipo_documento" varchar(20) NOT NULL, "documento" integer NOT NULL PRIMARY KEY, "fecha_expedicion" date NOT NULL, "primer_nombre" varchar(30) NOT NULL, "segundo_nombre" varchar(30) NULL, "primer_apellido" varchar(30) NOT NULL, "segundo_apellido" varchar(30) NULL, "sexo" varchar(1) NOT NULL, "fecha_nacimiento" date NOT NULL, "direccion" varchar(100) NOT NULL, "telefono" integer NOT NULL, "correo" varchar(254) NULL UNIQUE, "lugar_expedicion_id" varchar(10) NOT NULL REFERENCES "Administrativo_ciudad" ("codigo"), "lugar_nacimiento_id" varchar(10) NOT NULL REFERENCES "Administrativo_ciudad" ("codigo"), "usuario_id" integer NULL UNIQUE REFERENCES "auth_user" ("id"));
INSERT INTO "Administrativo_persona__new" ("fecha_nacimiento", "lugar_expedicion_id", "fecha_expedicion", "lugar_nacimiento_id", "usuario_id", "sexo", "correo", "segundo_apellido", "direccion", "segundo_nombre", "primer_apellido", "primer_nombre", "tipo_documento", "telefono", "documento") SELECT "fecha_nacimiento", "lugar_expedicion_id", "fecha_expedicion", "lugar_nacimiento_id", NULL, "sexo", "correo", "segundo_apellido", "direccion", "segundo_nombre", "primer_apellido", "primer_nombre", "tipo_documento", "telefono", "documento" FROM "Administrativo_persona";
DROP TABLE "Administrativo_persona";
ALTER TABLE "Administrativo_persona__new" RENAME TO "Administrativo_persona";
CREATE INDEX "Administrativo_persona_83d17944" ON "Administrativo_persona" ("lugar_expedicion_id");
CREATE INDEX "Administrativo_persona_da7c448b" ON "Administrativo_persona" ("lugar_nacimiento_id");
CREATE TABLE "Administrativo_pensum__new" ("codigo" varchar(10) NOT NULL PRIMARY KEY, "nombre" varchar(50) NOT NULL, "creditos" integer NOT NULL, "programa_id" varchar(10) NOT NULL REFERENCES "Administrativo_programa" ("codigo"));
INSERT INTO "Administrativo_pensum__new" ("nombre", "codigo", "programa_id", "creditos") SELECT "nombre", "codigo", NULL, "creditos" FROM "Administrativo_pensum";
DROP TABLE "Administrativo_pensum";
ALTER TABLE "Administrativo_pensum__new" RENAME TO "Administrativo_pensum";
CREATE INDEX "Administrativo_pensum_b8c24dbf" ON "Administrativo_pensum" ("programa_id");
CREATE TABLE "Administrativo_ciudad__new" ("codigo" varchar(10) NOT NULL PRIMARY KEY, "nombre" varchar(50) NOT NULL, "departamento_id" varchar(10) NOT NULL REFERENCES "Administrativo_departamento" ("codigo"));
INSERT INTO "Administrativo_ciudad__new" ("nombre", "codigo", "departamento_id") SELECT "nombre", "codigo", NULL FROM "Administrativo_ciudad";
DROP TABLE "Administrativo_ciudad";
ALTER TABLE "Administrativo_ciudad__new" RENAME TO "Administrativo_ciudad";
CREATE INDEX "Administrativo_ciudad_f5acfb16" ON "Administrativo_ciudad" ("departamento_id");
CREATE TABLE "Administrativo_aula__new" ("id" integer NOT NULL PRIMARY KEY AUTOINCREMENT, "nombre" varchar(50) NOT NULL, "bloque_id" varchar(2) NOT NULL REFERENCES "Administrativo_bloque" ("nombre"));
INSERT INTO "Administrativo_aula__new" ("nombre", "id", "bloque_id") SELECT "nombre", "id", NULL FROM "Administrativo_aula";
DROP TABLE "Administrativo_aula";
ALTER TABLE "Administrativo_aula__new" RENAME TO "Administrativo_aula";
CREATE INDEX "Administrativo_aula_689eaed8" ON "Administrativo_aula" ("bloque_id");
CREATE TABLE "Administrativo_horarioaula__new" ("id" integer NOT NULL PRIMARY KEY AUTOINCREMENT, "aula_id" integer NOT NULL REFERENCES "Administrativo_aula" ("id"), "hora_id" varchar(10) NOT NULL REFERENCES "Administrativo_hora" ("codigo"), UNIQUE ("hora_id", "aula_id"));
INSERT INTO "Administrativo_horarioaula__new" ("aula_id", "hora_id", "id") SELECT "aula_id", "hora_id", "id" FROM "Administrativo_horarioaula";
DROP TABLE "Administrativo_horarioaula";
ALTER TABLE "Administrativo_horarioaula__new" RENAME TO "Administrativo_horarioaula";
CREATE INDEX "Administrativo_horarioaula_d54dda25" ON "Administrativo_horarioaula" ("aula_id");
CREATE INDEX "Administrativo_horarioaula_1069c7b1" ON "Administrativo_horarioaula" ("hora_id");
CREATE TABLE "Administrativo_aula__new" ("id" integer NOT NULL PRIMARY KEY AUTOINCREMENT, "nombre" varchar(50) NOT NULL, "bloque_id" varchar(2) NOT NULL REFERENCES "Administrativo_bloque" ("nombre"), UNIQUE ("bloque_id", "nombre"));
INSERT INTO "Administrativo_aula__new" ("nombre", "id", "bloque_id") SELECT "nombre", "id", "bloque_id" FROM "Administrativo_aula";
DROP TABLE "Administrativo_aula";
ALTER TABLE "Administrativo_aula__new" RENAME TO "Administrativo_aula";
CREATE INDEX "Administrativo_aula_689eaed8" ON "Administrativo_aula" ("bloque_id");

COMMIT;
